---
title: 引数で渡した(任意の)ファイル名でスクリーンショットをとるAutoHotkey
author: azu
layout: post
permalink: /2010/0324/res1624/
SBM_count:
  - '00001<>1355232490<>1<>0<>0<>0<>0'
dsq_thread_id:
  - 303485805
categories:
  - software
tags:
  - クリップボード
  - 画像
---
とてもニッチなものですが、スクリーンショットソフトに引数で任意の文字列を渡し、スクリーンショットをとってクリップボードに保存すると引数のファイル名でスクリーンショットを保存できるAutoHotkeyスクリプトです。

自分の使い方

PDFなどを見ている時に、表示してる一部分を切り出して(スクリーンショットをとって)、その画像ファイル名を使って任意の場所に保存するのに利用してます。  
いわゆるスクリーンショットを使ったメモみたいな感じです。  
[Blog Forest: 読書メモの作成にevernoteを使う][1] とかに似てる。(これの電子版みたいな)

<!--more-->

必要なもの

*   [AutoHotkey][2] (コンパイルしないと動かないAHKスクリプトなので)
*   [imgctl.dll][3] (画像を保存するのに必要なdll)
*   クリップボードへ保存する機能があるスクリーンショットソフト(自動保存機能があると楽)

ダウンロード

*   [Clipboard.ahk ][4]

上記のソースコードで、使うスクリーンショットソフトのパスとなまず様のライブラリ使って保存するファイル名の置換などができるようにしてるので、そこを自由に編集する必要があると思います  
編集が終わったらAHKのスタートフォルダにConvert .ahk to .exeがあると思うので、それを使ってexeにコンパイルする。  
(上記のソースをコンパイルしてできたものをClipboard.exeとします。)  
そしてClipboard.exeとimgctl.dll を画像を保存したいフォルダに起きます。  
後はClipboard.exeにファイル名にする引数を渡して起動するだけ。

動作の流れ

ファイル名にしたい文字列を引数にしてClipboard.exeを起動→Clipboard.exeがパスを指定したスクリーンショットソフトを起動→スクリーンショットをとってクリップボードに保存→スクリーンショットソフトを落とす→スクリーンショットソフトが落ちたらクリップボードにある画像を任意のファイル名で書き出す

という面倒な流れになっています。スクリーンショットソフトのプロセスを監視して落ちるまで待ってるので何回でも取り直せます。(スクリーンショットソフトを落とした時、クリップボードにある画像が保存されます)

 [1]: http://morimorishop.com/2009/03/evernote_2.html
 [2]: http://www.autohotkey.com/
 [3]: http://www.ruche-home.net/?%A5%C0%A5%A6%A5%F3%A5%ED%A1%BC%A5%C9
 [4]: http://gist.github.com/raw/341280/bdce2c453edfc47793ce283aedf647b1889b26e8/Clipboard.ahk