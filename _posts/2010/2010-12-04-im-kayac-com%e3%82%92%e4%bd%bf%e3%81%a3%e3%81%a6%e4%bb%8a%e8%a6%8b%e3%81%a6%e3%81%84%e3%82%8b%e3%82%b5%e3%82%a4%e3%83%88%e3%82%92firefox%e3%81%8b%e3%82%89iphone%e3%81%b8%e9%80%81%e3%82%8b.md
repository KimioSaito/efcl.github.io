---
title: im.kayac.comを使って今見ているサイトをFirefoxからiPhoneへ送る
author: azu
layout: post
permalink: /2010/1204/res2165/
SBM_count:
  - '00001<>1355446365<>1<>0<>0<>0<>0'
dsq_thread_id:
  - 303485676
categories:
  - Firefox
  - iPhone
tags:
  - API
  - Firefox
  - iPhone
---
[im.kayac.com][1]というiPhoneへの通知を行うサービスがあるので、それを利用してFirefoxから今みているサイトのURLを送ってiPhoneからも簡単に開けるという感じのものを作ってみました。

準備するもの

1.  iPhoneの[im.kayac.com][2]アプリをダウンロード
2.  登録してパスワードを設定する

インストール

[Custom Buttons][3]のアドオンとして作ったので、[Custom Buttons][3]([Custom Buttons²][4])をインストールしておいて、下のボタンをクリックするとインストールできます。

[<img style="margin: 0 6px;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAFJ0lEQVRIiY2WS4wcVxWGv3Pure6enhmP48c4jieWY6w4EGEkZsMSsUNiwYZFFJbssnHEhlUES3YmC7ZIKJI3IFgECSnACiHxGCVhEEywE8+jx/Y8unu6q7uquqruPVlUT+yE55Vu6ZxTdf/zqjp/yc2XXuT9zY01k/J2Xo5fqcL0OcTAAARphP+65o8iBt4v7Xf8yl215EdfurXek3T2aK0M018Os/vreTUA7BRR/ify00swMTBT6STLPNO9udF2Z77pi9B//SjdWi/CAEXNojXAIoj8n36akMQkAs7SMpUyZOuryy+/7kdZ79W02ENUTYiidOm2z5HNjglWNXn/hzJ91iom8wtW15mMku63/Xi2e6mME8NMvJ3h5We/Tsdf5tHofXZGv0Nd+W8gZa59Wn8qVzEzG+W9VZ9VjylDKkbEJctU+RLRciw/w6g/oXu+aA6azh1Yg2SKiSHEBtocSPwkCMNE6oAvqhFVnIJAWmzzoHyHdrzK9v675MmQJATMAtEiFhVRQ0RQUaLVWGxib+z+SUYWiVbjyzCmjBmIkcgiufUYnDxGuhOSxZSirmjJIpeW11lorZAVJxxO/kpmKefaNzi/cgMM+uk9RtWHmChIRMwIlPhZSCljhllgsXOZr1x/DRVPf7LDr997g7MXlvjy869xceELRAzMOEw3GRU7XL/wNZwsI0C4mLGx81P2xu8gPoKBtxodZY+p4ogqjKliRgxGrIVZbpz0T3jh3Fc53/kidV1jQbAIFxZvcePCN9CwgJkRQgV1h1tXXiXrJ5RhRGkpaX6A39nfZGGpzWJ3iaXkKjEaRk0IJUWZs9J5gVhVRDEOju8joqyeu0rEsFiyu3+PK5eu03JdWtqlzs+Sjv7GrEqZTidoZRkn44f0Dv7Jw4P7DIdjptOcPC/IiiF1XVKHQB1qfv6bH/L7rTeJVkKI7Oxv8ZO3v8PO8Z/J8pzBcMTu3ja7+x8wSHvUscCr1+ZFi1DFgjyfUMwyjgbH9A626R8fkywMqC1n/3iTxbWz9PuHCF22e/cYVlv00wcsxZsgQlnOMImoB0Xwbt6QqGAEJpMMwVFkKSKRyXTMcDakjjmzakpReQbDAY6SaZYirqaYZUwsBaC2gPPgHDgMdU5QbQxlOKLUI5KkS//kISY13rVoJQu0kgVUHeoSEt8lSTp410YFVB0iDhRUQByoA+cF750nzj+OiiN++9Ft6sMX+WDvj6y+VPDeox9z9OAusY6Mqz2m4ZC33/0e04Fykh3QfiZBJCIKikMVVEEUnFO8umbqg2BEZoubzFb/zrXLQrIA/foPhCtNCM8nSpVMqFZ+RezCCkq728HMIVFADVFBHXNHDq/O0UwZQayR/VmACBFcW2h1tLkPWBTccjN7RCJqDRgKiKCqTclVmwycOJx4EAF7MhWN00M2n2/ScJEKxrwGYng8DkXFIaI4dTh1qDt1JoqipuZRUVQEETeXtamrNFtUEdG5LigOiBzO/kQlKYNsl97hP2glbUScORSv0jlAJpdEzAyVTzh4no3JfM4bCHpqbrI0TxRje/oLtj78CzsfHXDxcxm+7cxMRLR14NX5t3zsfjdYIYKYnPJ80/eG0OQJm5w6Q2TOBYa0hMW1XT6/5lDnzczEaxuvnbdURe+0kuUNpx0UmVO3mCBz9pv35umNzJ0oJh5BEHUmzszMidcF2v7MBuLuyLPXEr7/s2trmNyOoXolWnjuNGj7F9b97A/Hp3UVQ2k9VE3uRrE7P/jWdu9jvKOsQpXy/BUAAAAASUVORK5CYII=" border="0" alt="URL to im.kayac" />URL to im.kayac][5]

インストールしたら、Edit Buttonから

<pre>var username = "";
var password = "";
</pre>

を自分の情報にあわせて入力すれば完了。

iPhoneへ送りたいサイトを開いた状態で、ボタンを押せばiPhoneへプッシュ通知ができます。  
[<img class="alignnone size-full wp-image-2166" title="ss-2010-12-04-2" src="http://wordpress.local/wp-content/uploads/2010/12/ss-2010-12-04-2.png" alt="" width="218" height="115" />][6]

im.kayac.comのAPIがシンプルだったので10分ぐらいで作れましたが、かなり適当な作りしてます。

 [1]: http://im.kayac.com/
 [2]: http://itunes.apple.com/jp/app/id336129317
 [3]: https://addons.mozilla.org/ja/firefox/addon/2707/
 [4]: https://addons.mozilla.org/ja/firefox/addon/5066/
 [5]: custombutton://%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%3F%3E%0A%3Ccustombutton%20xmlns%3Acb%3D%22http%3A//custombuttons2.com/%22%3E%0A%20%20%3CCb2Ver%3E3.1.0%3C/Cb2Ver%3E%0A%20%20%3Cname%3EURL%20to%20im.kayac%3C/name%3E%0A%20%20%3Cimage%3E%3C%21%5BCDATA%5Bdata%3Aimage/png%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAFJ0lEQVRIiY2WS4wcVxWGv3Pure6enhmP48c4jieWY6w4EGEkZsMSsUNiwYZFFJbssnHEhlUES3YmC7ZIKJI3IFgECSnACiHxGCVhEEywE8+jx/Y8unu6q7uquqruPVlUT+yE55Vu6ZxTdf/zqjp/yc2XXuT9zY01k/J2Xo5fqcL0OcTAAARphP+65o8iBt4v7Xf8yl215EdfurXek3T2aK0M018Os/vreTUA7BRR/ify00swMTBT6STLPNO9udF2Z77pi9B//SjdWi/CAEXNojXAIoj8n36akMQkAs7SMpUyZOuryy+/7kdZ79W02ENUTYiidOm2z5HNjglWNXn/hzJ91iom8wtW15mMku63/Xi2e6mME8NMvJ3h5We/Tsdf5tHofXZGv0Nd+W8gZa59Wn8qVzEzG+W9VZ9VjylDKkbEJctU+RLRciw/w6g/oXu+aA6azh1Yg2SKiSHEBtocSPwkCMNE6oAvqhFVnIJAWmzzoHyHdrzK9v675MmQJATMAtEiFhVRQ0RQUaLVWGxib+z+SUYWiVbjyzCmjBmIkcgiufUYnDxGuhOSxZSirmjJIpeW11lorZAVJxxO/kpmKefaNzi/cgMM+uk9RtWHmChIRMwIlPhZSCljhllgsXOZr1x/DRVPf7LDr997g7MXlvjy869xceELRAzMOEw3GRU7XL/wNZwsI0C4mLGx81P2xu8gPoKBtxodZY+p4ogqjKliRgxGrIVZbpz0T3jh3Fc53/kidV1jQbAIFxZvcePCN9CwgJkRQgV1h1tXXiXrJ5RhRGkpaX6A39nfZGGpzWJ3iaXkKjEaRk0IJUWZs9J5gVhVRDEOju8joqyeu0rEsFiyu3+PK5eu03JdWtqlzs+Sjv7GrEqZTidoZRkn44f0Dv7Jw4P7DIdjptOcPC/IiiF1XVKHQB1qfv6bH/L7rTeJVkKI7Oxv8ZO3v8PO8Z/J8pzBcMTu3ja7+x8wSHvUscCr1+ZFi1DFgjyfUMwyjgbH9A626R8fkywMqC1n/3iTxbWz9PuHCF22e/cYVlv00wcsxZsgQlnOMImoB0Xwbt6QqGAEJpMMwVFkKSKRyXTMcDakjjmzakpReQbDAY6SaZYirqaYZUwsBaC2gPPgHDgMdU5QbQxlOKLUI5KkS//kISY13rVoJQu0kgVUHeoSEt8lSTp410YFVB0iDhRUQByoA+cF750nzj+OiiN++9Ft6sMX+WDvj6y+VPDeox9z9OAusY6Mqz2m4ZC33/0e04Fykh3QfiZBJCIKikMVVEEUnFO8umbqg2BEZoubzFb/zrXLQrIA/foPhCtNCM8nSpVMqFZ+RezCCkq728HMIVFADVFBHXNHDq/O0UwZQayR/VmACBFcW2h1tLkPWBTccjN7RCJqDRgKiKCqTclVmwycOJx4EAF7MhWN00M2n2/ScJEKxrwGYng8DkXFIaI4dTh1qDt1JoqipuZRUVQEETeXtamrNFtUEdG5LigOiBzO/kQlKYNsl97hP2glbUScORSv0jlAJpdEzAyVTzh4no3JfM4bCHpqbrI0TxRje/oLtj78CzsfHXDxcxm+7cxMRLR14NX5t3zsfjdYIYKYnPJ80/eG0OQJm5w6Q2TOBYa0hMW1XT6/5lDnzczEaxuvnbdURe+0kuUNpx0UmVO3mCBz9pv35umNzJ0oJh5BEHUmzszMidcF2v7MBuLuyLPXEr7/s2trmNyOoXolWnjuNGj7F9b97A/Hp3UVQ2k9VE3uRrE7P/jWdu9jvKOsQpXy/BUAAAAASUVORK5CYII%3D%5D%5D%3E%3C/image%3E%0A%20%20%3Cmode%3E0%3C/mode%3E%0A%20%20%3Ccode%3E%3C%21%5BCDATA%5B/*%20CONGIG%20*/%0A//%20http%3A//im.kayac.com/%20%u3067%u767B%u9332%u3057%u305F%u5024%u3092%u305D%u308C%u305E%u308C%u5165%u308C%u3066%u304F%u3060%u3055%u3044%0Avar%20username%20%3D%20%22%22%3B%0Avar%20password%20%3D%20%22%22%3B%0A/*%20CONGIG%20*/%0Avar%20xhr%20%3D%20new%20XMLHttpRequest%28%29%0Axhr.onload%20%3D%20function%28%29%20%7B%0A%20%20%20%20var%20res%20%3D%20JSON.parse%28xhr.responseText%29%3B%0A%20%20%20%20if%20%28res.result%20%3D%3D%20%22posted%22%29%20%7B%0A%20%20%20%20%20%20%20%20var%20alertsService%20%3D%20Components.classes%5B%22@mozilla.org/alerts-service%3B1%22%5D.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20getService%28Components.interfaces.nsIAlertsService%29%3B%0A%20%20%20%20%20%20%20%20alertsService.showAlertNotification%28%22chrome%3A//mozapps/skin/downloads/downloadIcon.png%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22im.kayac.com%22%2C%20%22im.kayac.com%u3078%u9001%u4FE1%u6210%u529F%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20false%2C%20%22%22%2C%20null%2C%20%22%22%29%3B%0A%20%20%20%20%7D%0A%7D%0Axhr.open%28%22POST%22%2C%20%22http%3A//im.kayac.com/api/post/%22+username%2C%20%22true%22%29%3B%0Axhr.setRequestHeader%28%22Content-Type%22%2C%20%22application/x-www-form-urlencoded%22%29%3B%0Axhr.send%28buildQuery%28%7B%0A%20%20%20%20%22handler%22%20%3A%20content.document.location.href%2C%0A%20%20%20%20%22password%22%3A%20password%2C%0A%20%20%20%20%22message%22%20%3A%20content.document.title%20+%20%22%20%3A%20%22%20+%20content.document.location.href%0A%7D%29%29%3B%0Afunction%20urlencode%28str%29%20%7B%0A%20%20%20%20str%20%3D%20%28str%20+%20%27%27%29.toString%28%29%3B%0A%20%20%20%20return%20encodeURIComponent%28str%29.replace%28/%21/g%2C%20%27%2521%27%29.replace%28/%27/g%2C%20%27%2527%27%29.replace%28/%5C%28/g%2C%20%27%2528%27%29.%0A%20%20%20%20%20%20%20%20%20%20%20%20replace%28/%5C%29/g%2C%20%27%2529%27%29.replace%28/%5C*/g%2C%20%27%252A%27%29.replace%28/%2520/g%2C%20%27+%27%29%3B%0A%7D%0Afunction%20buildQuery%28formdata%2C%20numeric_prefix%2C%20arg_separator%29%20%7B%0A%20%20%20%20//%20*%20%20%20%20%20example%201%3A%20http_build_query%28%7Bfoo%3A%20%27bar%27%2C%20php%3A%20%27hypertext%20processor%27%2C%20baz%3A%20%27boom%27%2C%20cow%3A%20%27milk%27%7D%2C%20%27%27%2C%20%27%26amp%3B%27%29%3B%0A%20%20%20%20//%20*%20%20%20%20%20returns%201%3A%20%27foo%3Dbar%26amp%3Bphp%3Dhypertext+processor%26amp%3Bbaz%3Dboom%26amp%3Bcow%3Dmilk%27%0A%20%20%20%20//%20*%20%20%20%20%20example%202%3A%20http_build_query%28%7B%27php%27%3A%20%27hypertext%20processor%27%2C%200%3A%20%27foo%27%2C%201%3A%20%27bar%27%2C%202%3A%20%27baz%27%2C%203%3A%20%27boom%27%2C%20%27cow%27%3A%20%27milk%27%7D%2C%20%27myvar_%27%29%3B%0A%20%20%20%20//%20*%20%20%20%20%20returns%202%3A%20%27php%3Dhypertext+processor%26myvar_0%3Dfoo%26myvar_1%3Dbar%26myvar_2%3Dbaz%26myvar_3%3Dboom%26cow%3Dmilk%27%0A%20%20%20%20var%20value%2C%20key%2C%20tmp%20%3D%20%5B%5D%3B%0A%20%20%20%20var%20_http_build_query_helper%20%3D%20function%20%28key%2C%20val%2C%20arg_separator%29%20%7B%0A%20%20%20%20%20%20%20%20var%20k%2C%20tmp%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20if%20%28val%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20val%20%3D%20%221%22%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28val%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20val%20%3D%20%220%22%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28val%20%21%3D%3D%20null%20%26%26%20typeof%28val%29%20%3D%3D%3D%20%22object%22%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20%28k%20in%20val%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28val%5Bk%5D%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20tmp.push%28_http_build_query_helper%28key%20+%20%22%5B%22%20+%20k%20+%20%22%5D%22%2C%20val%5Bk%5D%2C%20arg_separator%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20tmp.join%28arg_separator%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28typeof%28val%29%20%21%3D%3D%20%22function%22%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20urlencode%28key%29%20+%20%22%3D%22%20+%20urlencode%28val%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20Error%28%27There%20was%20an%20error%20processing%20for%20http_build_query%28%29.%27%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%20%20%20%20if%20%28%21arg_separator%29%20%7B%0A%20%20%20%20%20%20%20%20arg_separator%20%3D%20%22%26%22%3B%0A%20%20%20%20%7D%0A%20%20%20%20for%20%28key%20in%20formdata%29%20%7B%0A%20%20%20%20%20%20%20%20value%20%3D%20formdata%5Bkey%5D%3B%0A%20%20%20%20%20%20%20%20if%20%28numeric_prefix%20%26%26%20%21isNaN%28key%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20key%20%3D%20String%28numeric_prefix%29%20+%20key%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20tmp.push%28_http_build_query_helper%28key%2C%20value%2C%20arg_separator%29%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20tmp.join%28arg_separator%29%3B%0A%7D%5D%5D%3E%3C/code%3E%0A%20%20%3Cinitcode%3E%3C%21%5BCDATA%5B/*Initialization%20Code*/%5D%5D%3E%3C/initcode%3E%0A%20%20%3Caccelkey%3E%3C%21%5BCDATA%5B%5D%5D%3E%3C/accelkey%3E%0A%20%20%3Chelp%3E%3C%21%5BCDATA%5B%5D%5D%3E%3C/help%3E%0A%3C/custombutton%3E "URL to im.kayac"
 [6]: http://wordpress.local/wp-content/uploads/2010/12/ss-2010-12-04-2.png