---
title: Vista上でregsvr32を行うとエラーが起きる(batファイル、datファイル)
author: azu
layout: post
permalink: /2008/0120/res24/
SBM_count:
  - '00003<>1355386636<>3<>0<>0<>0<>0'
dsq_thread_id:
  - 300801276
categories:
  - vista
tags:
  - vista
---
VistaでDLLをインストール（レジスト？）するときに.batファイルや.datファイルを実行する場合に  
XPだと常に管理者権限なので、そのまま実行すればインストールできます。  
しかし、VistaはUACという機能のためにダブルクリックだけではできないときが多々あります。  
**多くの場合は右クリックから管理者権限で実行する  
**という手段で解決すると思います。

[Vistaでregsvr32すると0&#215;80040200がでる &#8211; 昼間のメモ][1]

上のサイトのようにコマンドプロンプト(アクセサリにある)を管理者権限で実行してから、  
regsvr32 ファイル名  
regsvr32 /u ファイル名  
とやればいい。  
**（上がインストールで下がアンインストールです。）**

しかし、Vistaの仕様の変更は他にもあって、.batファイルには上記のようなコマンドが  
書かれているのですが、その多くは相対アドレス(現在位置からのアドレス)で書かれているはずです。  
Vistaではなぜか相対アドレスだとダメな場合が存在します。  
なので失敗する場合は絶対アドレスでコマンドを打つと大丈夫になります。  
(「～～呼び出しは <span class="keyword">エラー</span><span class="keyword">コード</span>0&#215;80070005により失敗しました」というエラーが出る場合はまさにこれです)

例えば  
regsvr32 hoge.dll  
hoge.dllをインストールするという意味。

と書かれているbatファイルが 失敗する場合は  
regsvr32 &#8220;C:Usersnicknamesofthoege.dll&#8221;  
というように絶対アドレスに書き換えるかコマンドプロンプトでそのようにコマンドを  
打つと解決するかも知れません。(ダブルコーテーションでくくる必要あるかも)

 [1]: http://blog.goo.ne.jp/hiuchida/e/d08d9975b7f9dcad72d4031a9e18d24a