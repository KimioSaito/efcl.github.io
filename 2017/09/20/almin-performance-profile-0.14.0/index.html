<p><a href="https://github.com/almin/almin"><img src="https://almin.github.io/media/logo/logo.png" alt="Almin.js"></a></p>

<p><a href="https://github.com/almin/almin" title="Almin">Almin</a> is a State management library like Redux/Flux. But Almin aim to help Client-side DDD/CQRS.</p>

<p>This architecture is also known as <a href="https://www.safaribooksonline.com/library/view/software-architecture-patterns/9781491971437/ch01.html" title="Layered Architecture">Layered Architecture</a>.</p>

<p><img src="https://almin.js.org/docs/resources/almin-architecture.png" alt="Architecture"></p>

<p>We have released <a href="https://github.com/almin/almin/releases/tag/almin%400.14.0" title="almin@0.14.0">Almin 0.14.0</a> that support to measure performance profile based on <code>performance.mark</code>.
You can profiling UseCase execute, StoreGroup write/read, Store update using the browser developer tool timeline.</p>

<p>TK: image
<a href="https://github.com/almin/almin/releases/tag/almin%400.14.0"><img src="http://efcl.info/wp-content/uploads/2017/09/20-1505888631.png" alt="DevTool timeline"></a></p>

<p><code>performance.mark</code> is defined <a href="https://w3c.github.io/user-timing/" title="User Timing Level 2">User Timing Level 2</a> as W3C standard API.
It means that almin work with other library like React and Vue on performance profile.</p>

<h2 id="usage">Usage</h2>

<p>If you have not heard of almin, please see <a href="https://almin.js.org/" title="Introduction · Almin.js">Introduction · Almin.js</a></p>

<p>You can turn on performance profile by <code>performanceProfile</code> option.</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">appContext</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Context</span><span class="p">({</span>
    <span class="nx">dispatcher</span><span class="o">:</span> <span class="k">new</span> <span class="nx">Dispatcher</span><span class="p">(),</span>
    <span class="nx">store</span><span class="o">:</span> <span class="nx">yourStoreGroup</span><span class="p">,</span>
    <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">strict</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="nx">performanceProfile</span><span class="o">:</span> <span class="kc">true</span> <span class="c1">// &lt;= here</span>
    <span class="p">}</span>
<span class="p">});</span>
</code></pre></div>
<h3 id="steps">Steps</h3>

<ol>
<li>Turn on <code>performanceProfile</code> option</li>
<li>Load your app</li>
<li>Open the browser DevTools &quot;Performance&quot; tab and press <strong>Record</strong>

<ul>
<li>For more details, See <a href="https://developers.google.com/web/tools/chrome-devtools/evaluate-performance/timeline-tool">Chrome&#39;s Timeline Tool document</a> and <a href="https://docs.microsoft.com/en-us/microsoft-edge/f12-devtools-guide/performance" title="F12 devtools guide - Performance - Microsoft Edge Development | Microsoft Docs">MSEdge&#39;s F12 devtools guide</a></li>
</ul></li>
<li>Stop recording</li>
<li>Almin events will be grouped under the <strong>User Timing</strong> label</li>
</ol>

<p>Actually, you can see performance profile with Chrome DevTool timeline.</p>

<blockquote class="twitter-video" data-lang="en"><p lang="en" dir="ltr"><a href="https://twitter.com/hashtag/almin?src=hash">#almin</a> + <a href="https://twitter.com/hashtag/react?src=hash">#react</a> easy to profile web app with devTool&#39;s timeline.<a href="https://t.co/HLndVyS4hI">https://t.co/HLndVyS4hI</a> <a href="https://t.co/d7l2c2pP1K">pic.twitter.com/d7l2c2pP1K</a></p>&mdash; azu (@azu_re) <a href="https://twitter.com/azu_re/status/909418278153478144">September 17, 2017</a></blockquote>

<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>

<p>This video show Almin + React on timeline.
React has <a href="https://facebook.github.io/react/docs/optimizing-performance.html" title="?react_perf">?react_perf</a> options that does profiling performance.</p>

<p>That example code is following.</p>

<ul>
<li><a href="https://github.com/almin/almin/tree/master/examples/shopping-cart" title="almin/examples/shopping-cart at master · almin/almin">almin/examples/shopping-cart at master · almin/almin</a></li>
</ul>

<h2 id="vue-almin">Vue + Almin</h2>

<p>Vue also support <a href="https://vuejs.org/v2/api/#performance"><code>performance</code> option</a> based on <code>performance.mark</code>.</p>

<p>I&#39;ve created a example project that use Almin + Vue.</p>

<ul>
<li><a href="https://github.com/azu/vue-almin-counter-example" title="azu/vue-almin-counter-example: Vue + Almin counter example">azu/vue-almin-counter-example: Vue + Almin counter example</a></li>
</ul>

<p><img src="https://cdn.rawgit.com/azu/vue-almin-counter-example/master/img/performance-timeline.gif" alt="Vue + Almin"></p>

<ul>
<li>Vue&#39;s profile show view metrics(<code>render</code> and <code>patch</code>)</li>
<li>Almin&#39;s profile show UseCase execute, StoreGroup write/read, Store update time</li>
</ul>

<p>The collection of metrics is writtend in following document.</p>

<p><a href="https://almin.js.org/docs/tips/performance-profile.html"><img src="http://efcl.info/wp-content/uploads/2017/09/20-1505887064.png" alt="Metrics"></a></p>

<ul>
<li><a href="https://almin.js.org/docs/tips/performance-profile.html" title="Performance profile · Almin.js">Performance profile · Almin.js</a></li>
</ul>

<p>This project is migrated from Vue + Vuex to Vue + Almin.
The diff is following.</p>

<ul>
<li><a href="https://github.com/azu/vue-almin-counter-example/pull/1" title="Almin + Vue performance profile by azu · Pull Request #1 · azu/vue-almin-counter-example">Almin + Vue performance profile by azu · Pull Request #1 · azu/vue-almin-counter-example</a></li>
</ul>

<h2 id="conclusion">Conclusion</h2>

<p>Almin can measure performance profile with browser DevTools.</p>

<ul>
<li><a href="https://developers.google.com/web/tools/chrome-devtools/evaluate-performance/timeline-tool">Chrome&#39;s Timeline Tool document</a></li>
<li><a href="https://docs.microsoft.com/en-us/microsoft-edge/f12-devtools-guide/performance" title="F12 devtools guide - Performance - Microsoft Edge Development | Microsoft Docs">MSEdge&#39;s F12 devtools guide</a></li>
</ul>

<p>This performance profile also work with the other library like React, or Vue.</p>

<p>You can find bottleneck using these metrics.</p>

<p>For more details, See followoing documents.</p>

<ul>
<li><a href="https://almin.js.org/docs/tips/performance-profile.html" title="Performance profile · Almin.js">Performance profile · Almin.js</a></li>
<li><a href="https://almin.js.org/docs/tips/usecase-lifecycle.html" title="LifeCycle of UseCase · Almin.js">LifeCycle of UseCase · Almin.js</a></li>
</ul>

<p></p>
